<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Sinatra with Stripe API</title>
	<link rel="stylesheet" href="https://stripe-samples.github.io/developer-office-hours/demo.css" type="text/css">
</head>
<body>
	<div id="main">
		<div id="container">
			<div id="panel">
				<h1>Sinatra Demo with Stripe API</h1>
				<button type="submit" id="btn">Click me!</button>
			</div>
		</div>
	</div>
	<script type="text/javascript" src="https://js.stripe.com/v3/"></script>
	<script>
		var stripe;
		fetch("/public-keys")
			.then(response => response.json())
			.then(data => {
				stripe = Stripe(data.key);
				console.log("Success: ", data);
			})
			.catch(err => {
				console.error("Error: ", error);
			});

		var button = document.getElementById("btn");
		btn.addEventListener("click", function(e) {
			e.preventDefault();
			fetch("/my-post-route", {
				method: "POST",
				headers: {
					"Content-Type": "application/json",
				},
				body: JSON.stringify({
					test: "abc123",
					payment_method: "pm_card_visa",
					customer: "cus_23abc",
					address: {
						line1: "123 Main St",
					}
				}),
			})
				.then(response => response.json())
				.then(data => {
					console.log("Success: ", data);
				})
				.catch(err => {
					console.error("Error: ", error);
				});
		})

		console.log("hello world");
	</script>
</body>
</html>